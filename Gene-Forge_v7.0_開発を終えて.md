# 開発を終えて — Gene-Forge v7.0 総括

-----

## 概要

Gene-Forge v7.0は、コザクラインコ（Rosy-faced Lovebird / *Agapornis roseicollis*）の繁殖支援システムとして完成を迎えた。本ドキュメントは、システムの技術的到達点と設計思想を総括するものである。

-----

## 1. アーキテクチャ評価

本システムは単なる「計算機」の域を超え、**「SSOT（信頼できる唯一の情報源）に基づいた静的型付け指向のデータ駆動型システム」**として非常に高度に洗練されている。

### 1.1 SSOT (Single Source of Truth) の徹底

`genetics.php` 内の `AgapornisLoci::LOCI` が全ての根源となっており、JavaScript側（`breeding.js`, `planner.js`）がハードコードを一切持たず、この定義を動的に参照して計算を行う構造は、拡張性と保守性が極めて高い。

### 1.2 階層化されたバリデーション・パイプライン

単に交配結果を出すだけでなく、以下の3層のガードレールが機能している：

|Layer                                             |責務                                          |
|--------------------------------------------------|--------------------------------------------|
|**Genetics Layer** (`genetics.php`)               |ALBS準拠の純粋な遺伝確率計算                            |
|**Health Layer** (`guardian.js`)                  |近交係数（Wright's F）およびINO/Pallid系の特有リスクによる倫理的制約|
|**Application Layer** (`family.js` / `planner.js`)|「事実モード」と「計画モード」の切り分けによる実運用への即応              |

### 1.3 遺伝学的知識とUIロジックの分離

本システムの最大の特徴は、**「遺伝学的知識の集約化（PHP）」と「リアクティブなUIロジック（JS）」の分離、およびその間の「共通定義の同期」**の美しさにある。

-----

## 2. コンポーネント別技術評価

### 2.1 計算エンジン：Genetics & Inference

**推論の深さ**

`infer.php` および `FamilyEstimatorV3` の実装は、ベイズ推定に近いアプローチで家系図を遡及・走査しており、単一の交配ペアだけでなく「一族」の情報を統合してスプリットを特定するロジックは、既存のインコ計算ツールを圧倒している。

**マルチアレル・伴性遺伝の処理**

伴性遺伝（Z染色体）の性別による不均衡を `AgapornisLoci::LOCI` の `sex_linked` フラグで抽象化し、ロジックを共通化している点は非常にスマートである。

**v7.0での連鎖遺伝実装**

|連鎖群 |座位              |組換え率|
|----|----------------|----|
|Z染色体|cinnamon-ino    |3%  |
|Z染色体|ino-opaline     |30% |
|Z染色体|cinnamon-opaline|33% |
|常染色体|dark-parblue    |7%  |

### 2.2 リスク管理：Health Guardian

**Wright's F-coefficient の実装**

`guardian.js` における `calcInbreedingCoefficient` の実装は、単純な親子判定に留まらず、共通祖先を再帰的に特定する本格的なアルゴリズムが採用されている。

**ドメイン特化ルール**

「INO系2世代到達でのアラート」など、実際のブリーダー経験に基づいた閾値設定がプログラムに「規律」を与えている。

### 2.3 UI/UX連携：FamilyMap & Planner

**Plannerの逆算ロジック**

`planner.js` は、DB内の在庫個体から「目標」に到達するためのペアをTOP5で提案する、まさに「実務支援」の核心である。確率だけでなく「F値（近交係数）」をソートの重み付けに使っている点がプロ仕様と言える。

-----

## 3. 到達点

### 3.1 数値で見る完成度

|指標    |値             |
|------|--------------|
|対応座位数 |14            |
|対応色数  |310+          |
|対応言語  |6（日/英/独/仏/伊/西）|
|ALBS準拠|完全            |

### 3.2 Version 7 総合評価

**評価：S (Professional Grade)**

本システムは、以下の3つのバランスが極めて高い次元で取れている：

|観点     |実装                                                     |
|-------|-------------------------------------------------------|
|**正確性**|ALBS Peachfaced部門の最新の命名規則と遺伝学的正しさをコード化した `genetics.php`|
|**安全性**|`BreedingValidator` による、近親交配を物理的に警告・遮断する倫理的設計          |
|**実用性**|localStorage を活用したオフラインDBと、多言語対応によるグローバル展開への備え         |

----

## 4. 今後の展望

`lang.php` に「セキセイインコ版 Coming soon」の記述があるように現在の `AgapornisLoci` クラスを抽象クラス化し、鳥種ごとの Loci クラスを注入する形（ストラテジーパターン）にすれば、コードの大部分を再利用したまま多種展開が容易な構造になっている。

### 4.1 コザクラインコ版の完成宣言

v7.0をもって、コザクラインコ繁殖支援システムとしての Gene-Forge は**機能的完成**を達成した。

- 全14座位カバー
- 310+色対応
- 連鎖遺伝完全実装
- 健康管理機能搭載
- 6言語対応

もうやることがない = 完成の証拠

-----

## 結語

> 「制度は責任を放棄した。制度外がそれを果たす。」

Gene-Forge は、世界中のコザクラインコ繁殖家が科学的根拠に基づいた繁殖計画を立てられるよう、オープンに提供される。

本システムが、鳥たちの健康と遺伝的多様性の維持に貢献することを願う。

-----

*制度外文明・かならづプロジェクト*
*2026年1月*
